<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proceso de Observaci√≥n Quejas - Afore Coppel</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configuraci√≥n de color para un look corporativo (Azul/Gris) -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        .card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .text-coppel-blue {
            color: #1f3a93; /* Un azul corporativo */
        }
        .bg-coppel-blue {
            background-color: #1f3a93;
        }
        /* Custom styles for chart bars (using data to define width in JS) */
        .bar-container {
            min-height: 4rem; /* M√≠nimo 4rem para acomodar 2 o 3 l√≠neas de texto */
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        .bar-label {
            /* AJUSTE CLAVE: Se aumenta el ancho y se permite el salto de l√≠nea */
            width: 45%; 
            font-size: 0.875rem;
            color: #4b5563;
            font-weight: 500;
            padding-right: 1rem; /* Espacio extra entre label y barra */
        }
        .bar-wrapper {
            display: flex;
            align-items: center;
            height: 100%;
        }
        .bar {
            background-color: #3b82f6; /* Azul brillante para los datos */
            min-height: 2.5rem; /* Asegura que la barra sea lo suficientemente alta */
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            padding: 0 0.5rem;
        }
        /* Estilo para el texto dentro de la barra (blanco y m√°s legible) */
        .bar-text {
            color: white;
            /* AJUSTE CLAVE: Tama√±o de fuente reducido a 0.6rem para asegurar visibilidad en barras cortas */
            font-size: 0.6rem; 
            font-weight: 700;
            white-space: nowrap; /* Mantiene el texto de la data en una sola l√≠nea */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        /* Estilo para la tabla m√°s espaciada */
        .styled-table th, .styled-table td {
            padding: 1rem 0.75rem; /* M√°s padding vertical y horizontal */
        }

        /* --- ESTILOS DE MAPA --- */
        .map-container {
            width: 100%;
            height: 300px; /* Altura fija para el mapa */
            background-color: #f7f7f7; /* Fondo neutro */
            border-radius: 0.5rem;
            position: relative;
            overflow: hidden;
            /* CAMBIO CLAVE: Contenedor para la etiqueta IMG */
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #ccc;
        }
        /* Se eliminaron los estilos de .map-marker y .marker-tooltip ya que se usa IMG */
        
        /* Estilos para el Gr√°fico de Pastel (Pie Chart Simulation) */
        .pie-chart-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            position: relative;
            /* Gradiente actualizado para orden 1, 2, 3 (43.2%, 13.6%, 43.2%) */
            background: conic-gradient(
                #1f3a93 0% 43.2%, 
                #3b82f6 43.2% 56.8%, 
                #63b3ed 56.8% 100%
            );
            border-radius: 50%;
            margin-top: 2rem;
        }
        .pie-legend {
            list-style: none;
            padding: 0;
            margin-top: 1rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        .legend-color {
            width: 1rem;
            height: 1rem;
            border-radius: 0.25rem;
            margin-right: 0.5rem;
        }

        /* Estilos para la tabla de Hallazgos y Propuestas */
        .hallazgos-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Dos columnas iguales */
            border: 1px solid #e5e7eb; /* Borde exterior */
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }
        .hallazgo-header {
            background-color: #f3f4f6;
            font-weight: 700;
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            color: #1f3a93;
            text-align: center;
        }
        .hallazgo-content {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            /* CLAVE: Centrado Vertical */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .hallazgo-content p {
            max-width: 90%; /* Limita el ancho del texto para centrarlo mejor */
        }
        .propuesta-content {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            border-left: 1px solid #e5e7eb;
            /* CAMBIO: Eliminando colores para formato de tabla simple */
            background-color: #fff; 
            color: #4b5563; 
            font-weight: 500;
            text-align: left; /* Asegura que el texto de la propuesta se lea de forma natural */
        }
        .propuesta-content strong {
            color: #1f3a93; /* Azul para resaltar acciones */
            font-weight: 700;
        }
        /* Estilo para los listados de tiendas */
        .tiendas-list {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px dashed #d1d5db;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <header class="mb-8 border-b-4 border-coppel-blue pb-4">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-coppel-blue">Proceso de Observaci√≥n Quejas</h1>
        <p class="text-lg text-gray-600 mt-1">Septiembre 2025 | 44 Quejas</p>
    </header>

    <!-- Resumen Ejecutivo y Focos de Acci√≥n -->
    <section class="mb-10">
        <!-- T√≠tulo de la secci√≥n principal -->
        <h2 class="text-2xl font-bold mb-4 text-gray-800 border-l-4 border-red-500 pl-3">Resumen General</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

            <!-- Foco 1: Cultura de Servicio -->
            <div class="card p-5 bg-white rounded-lg border-t-4 border-red-600 text-center">
                <p class="text-sm font-semibold text-red-600">FOCO CR√çTICO DE CX</p>
                <h3 class="text-xl font-bold mt-1 text-gray-900">Mala Actitud en la Atenci√≥n</h3>
                <p class="text-3xl font-extrabold text-red-600 mt-2">36.4%</p>
                <p class="text-sm text-gray-500 mt-1">De todas las quejas est√°n relacionadas con la percepci√≥n de una <strong>mala actitud</strong> del personal.</p>
            </div>

            <!-- Foco 2: Rigidez Operativa -->
            <div class="card p-5 bg-white rounded-lg border-t-4 border-yellow-600 text-center">
                <p class="text-sm font-semibold text-yellow-600">FOCO OPERATIVO</p>
                <h3 class="text-xl font-bold mt-1 text-gray-900">Restricciones de Acceso</h3>
                <p class="text-3xl font-extrabold text-yellow-600 mt-2">27.2%</p>
                <!-- NEGRITAS APLICADAS AQU√ç -->
                <p class="text-sm text-gray-500 mt-1">Quejas por <strong>horarios limitados</strong> y <strong>condicionamiento de citas</strong> <strong>(13.6% cada una)</strong>.</p>
            </div>

            <!-- Foco 3: Impacto Regional -->
            <div class="card p-5 bg-white rounded-lg border-t-4 border-green-600 text-center">
                <p class="text-sm font-semibold text-green-600">FOCO GEOGR√ÅFICO</p>
                <h3 class="text-xl font-bold mt-1 text-gray-900">Regi√≥n Mexicali y Coordinador</h3>
                <p class="text-3xl font-extrabold text-green-600 mt-2">7/44</p>
                <!-- NEGRITAS APLICADAS AQU√ç -->
                <p class="text-sm text-gray-500 mt-1"><strong>Mexicali</strong> es la regi√≥n con m√°s quejas (7). El volumen se reparte entre <strong>dos coordinadores</strong>: <strong>Jos√© Luis Feria Flores</strong> <strong>(4 casos)</strong> y <strong>Nadia Elena Gonz√°lez Lopez</strong> <strong>(3 casos)</strong>.</p>
            </div>

        </div>
    </section>

    <!-- Gr√°ficos de Tipificaci√≥n por Motivo y Servicio -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">

        <!-- GR√ÅFICO 1: Top 5 Motivos de Queja (Tipificaci√≥n General) -->
        <div class="card p-6 bg-white rounded-lg">
            <!-- T√≠tulo centrado -->
            <h3 class="text-xl font-semibold mb-4 text-text-coppel-blue text-center">Top 5: Motivos de Queja</h3>
            <div id="chart-motivos" class="space-y-2">
                <!-- Barras generadas por JS -->
            </div>
        </div>

        <!-- GR√ÅFICO 2: Tipificaci√≥n por Servicio (Impacto Operativo) -->
        <div class="card p-6 bg-white rounded-lg">
            <h3 class="text-xl font-semibold mb-4 text-text-coppel-blue">Impacto de la Mala Actitud por Tipo de Servicio</h3>
            <p class="text-sm text-gray-500 mb-4">Quejas relacionadas con "Mala Actitud" y "Condicionamiento de Cita" en los <strong>5 servicios principales</strong>:</p>
            <table class="min-w-full divide-y divide-gray-300 styled-table">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider rounded-tl-lg">Servicio</th>
                        <th class="px-3 py-2 text-center text-xs font-medium text-gray-700 uppercase tracking-wider">Mala Actitud</th>
                        <th class="px-3 py-2 text-center text-xs font-medium text-gray-700 uppercase tracking-wider rounded-tr-lg">Condici√≥n Cita</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200 text-sm" id="table-servicio">
                    <!-- Filas generadas por JS -->
                </tbody>
            </table>
        </div>

    </section>

    <!-- NUEVA SECCI√ìN: An√°lisis de Concentraci√≥n por Ciudad y Divisi√≥n -->
    <section class="mb-10">

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- GR√ÅFICO 3: Mapa de Burbujas de Quejas por Ciudad -->
            <div class="card p-6 bg-white rounded-lg">
                <!-- T√çTULO CORREGIDO Y CENTRADO -->
                <h3 class="text-xl font-semibold mb-4 text-text-coppel-blue text-center">Quejas por Ciudad</h3>
                <!-- SUBT√çTULO CORREGIDO -->
                <p class="text-sm text-gray-500 mb-4 text-center">Concentraci√≥n de quejas por ciudad y estado.</p>
                <div id="map-friccion" class="map-container">
                    <!-- Etiqueta IMG para asegurar la carga de la imagen -->
                    <img src="uploaded:quejas septiembre imagen mapa mexico.png-f0fb9749-8217-4c6a-b80d-ae023fa92774" 
                         alt="Mapa de M√©xico con puntos de queja por ciudad" 
                         class="max-w-full max-h-full object-contain">
                </div>
            </div>

            <!-- GR√ÅFICO 4: Distribuci√≥n por Divisi√≥n (Pie Chart Simulation) -->
            <div class="card p-6 bg-white rounded-lg">
                <h3 class="text-xl font-semibold mb-4 text-text-coppel-blue text-center">Distribuci√≥n de Quejas por Divisi√≥n</h3>
                <div class="flex flex-col items-center">
                    <div id="chart-division" class="pie-chart-container w-48 h-48">
                        <!-- El gr√°fico de pastel se genera en CSS/JS -->
                    </div>
                    <ul id="pie-legend" class="pie-legend">
                        <!-- Leyenda generada por JS -->
                    </ul>
                </div>
            </div>

        </div>
    </section>

    <!-- HALLAZGOS OPERATIVOS Y ESTRAT√âGICOS -->
    <section class="mb-10">
        <!-- T√çTULO CAMBIADO -->
        <h2 class="text-2xl font-bold mb-4 text-gray-800 border-l-4 border-coppel-blue pl-3">Hallazgos y Propuestas de Soluci√≥n</h2>

        <div class="card bg-white rounded-lg">
            
            <div class="hallazgos-grid">
                <!-- Encabezados de la Tabla -->
                <div class="hallazgo-header">HALLAZGO CLAVE</div>
                <div class="hallazgo-header border-l border-gray-300">PROPUESTA DE SOLUCI√ìN</div>
                
                <!-- Fila 1: MALA ACTITUD (36.4%) -->
                <div class="hallazgo-content">
                    <p>üî¥ La <strong>mala actitud</strong> del personal es el motivo TOP 1 <strong>(36.4%)</strong>.</p>
                </div>
                <div class="propuesta-content">
                    ‚úÖ Buscar que nos compartan un curso sobre el <strong>buen trato a los clientes</strong> y poder asignarlo a los <strong>Asesores Previsionales</strong> que reporten por mala actitud.
                </div>

                <!-- Fila 2: FOCO GEOGR√ÅFICO MEXICALI -->
                <div class="hallazgo-content">
                    <p>üî¥ La <strong>Regi√≥n Mexicali</strong> concentra el mayor volumen de quejas <strong>(7 casos)</strong>. El volumen se reparte entre <strong>dos coordinadores</strong>: <strong>Jos√© Luis Feria Flores</strong> <strong>(4 casos)</strong> y <strong>Nadia Elena Gonz√°lez Lopez</strong> <strong>(3 casos)</strong>.</p>
                </div>
                <div class="propuesta-content">
                    ‚úÖ Llevar un proceso de intervenci√≥n por parte de la <strong>Gerencia de Atenci√≥n a M√≥dulos</strong> para las tiendas y coordinadores de la regi√≥n <strong>Mexicali</strong>.
                    <div class="tiendas-list text-xs font-medium text-gray-700">
                        <p class="font-bold mb-1">Tiendas afectadas en Mexicali:</p>
                        <ul class="list-disc list-inside ml-2">
                            <li>22 - SERDAN LL</li>
                            <li>32 - EL SAHUARO</li>
                            <li>34 - OBREGON IV</li>
                            <li>75 - CONSTITUCION</li>
                            <li>97 - LAS BRISAS</li>
                            <li>110 - JUAREZ IV</li>
                            <li>1395 - SENDERO 2000</li>
                        </ul>
                    </div>
                </div>

                <!-- Fila 3: RIGIDEZ OPERATIVA (Horarios y Cita) -->
                <div class="hallazgo-content">
                    <p>üî¥ Los <strong>horarios limitados</strong> y <strong>condicionamiento de citas</strong> representan el <strong>27.2%</strong> del volumen, impidiendo al cliente completar <strong>tr√°mites deseados</strong>.</p>
                </div>
                <div class="propuesta-content">
                    ‚úÖ Reforzamiento y comunicados de la <strong>Carta de Derechos de los usuarios</strong>, focalizando la atenci√≥n de todos los trabajadores <strong>con y sin cita</strong>.
                </div>
                
                <!-- Fila 4: SEGMENTO ADULTO MAYOR -->
                <div class="hallazgo-content border-b-0">
                    <p>üî¥ El <strong>11.4%</strong> de las quejas provienen de la <strong>poblaci√≥n de adultos mayores</strong>, un grupo sensible a <strong>procesos complejos</strong>.</p>
                </div>
                <div class="propuesta-content border-b-0">
                    ‚úÖ Llevar a cabo un proceso de intervenci√≥n por parte de la <strong>Gerencia de Pensiones</strong> para el reforzamiento al <strong>Protocolo de Adultos Mayores (PAM)</strong> para las tiendas que incumplan con dicho protocolo.
                    <div class="tiendas-list text-xs font-medium text-gray-700">
                        <p class="font-bold mb-1">Tiendas con quejas de Adultos Mayores:</p>
                        <ul class="list-disc list-inside ml-2">
                            <li>22 - SERDAN LL</li>
                            <li>32 - EL SAHUARO</li>
                            <li>40 - CARRANZA III</li>
                            <li>60 - LOPEZ MATEOS</li>
                            <li>74 - DIAZ MIRON</li>
                            <li>110 - JUAREZ IV</li>
                            <li>160 - HIDALGO</li>
                            <li>296 - TRANSPENINSULAR</li>
                            <li>871 - PLAZA JARDINES</li>
                            <li>975 - PLAZA CHAUE</li>
                            <li>983 - BUENAVISTA</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <footer class="mt-10 pt-4 border-t border-gray-300 text-center text-sm text-gray-500">
        <!-- CAMBIO SOLICITADO AQU√ç -->
        <p>&copy; 2025 Afore Coppel. Reporte Generado por la Gerencia de Atenci√≥n al P√∫blico.</p>
    </footer>

    <script>
        // Datos del an√°lisis generado (Frecuencias de 44 quejas)
        const dataMotivos = [
            { label: "Percib√≠ una mala actitud en la atenci√≥n", value: 36.4, count: 16 },
            { label: "No pude hacer el tr√°mite, por horarios limitados", value: 13.6, count: 6 },
            { label: "No pude hacer el tr√°mite, porque me condicionaron contar con cita", value: 13.6, count: 6 },
            { label: "No pude hacer el tr√°mite, por ausencia de personal", value: 6.8, count: 3 },
            { label: "No pude hacer el tr√°mite, porque no me respetaron mi cita", value: 6.8, count: 3 },
        ];

        // DATOS ACTUALIZADOS: Top 5 servicios con mayor volumen de quejas
        const dataServicio = [
            { servicio: "Alta de Expediente y Biometrico", malaActitud: 4, condicionCita: 1 },
            { servicio: "Retiros Totales IMSS", malaActitud: 3, condicionCita: 1 },
            { servicio: "Modificaci√≥n de Datos", malaActitud: 3, condicionCita: 1 },
            { servicio: "Retiro por Desempleo", malaActitud: 2, condicionCita: 0 },
            { servicio: "Actualizaci√≥n de datos", malaActitud: 0, condicionCita: 2 },
        ];
        
        // DATOS DE DIVISI√ìN REORDENADOS: 1, 2, 3
        const dataDivision = [
            { division: "Divisi√≥n 1", count: 19, percentage: 43.2, color: '#1f3a93' }, // Azul Corporativo (43.2%)
            { division: "Divisi√≥n 2", count: 6, percentage: 13.6, color: '#3b82f6' }, // Azul Intermedio (13.6%)
            { division: "Divisi√≥n 3", count: 19, percentage: 43.2, color: '#63b3ed' }, // Azul Claro (43.2%)
        ];


        // Funci√≥n para renderizar el gr√°fico de barras (Motivos)
        function renderMotivosChart() {
            const container = document.getElementById('chart-motivos');
            dataMotivos.forEach(item => {
                const barContainer = document.createElement('div');
                barContainer.className = 'bar-container';

                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = item.label; // El texto puede ocupar varias l√≠neas

                const barWrapper = document.createElement('div');
                barWrapper.className = 'bar-wrapper flex-grow';

                const bar = document.createElement('div');
                bar.className = 'bar transition-all duration-700 ease-out';
                // Calculamos el ancho relativo al 40% (valor m√°ximo del TOP)
                const widthPercent = (item.value / 40) * 100;
                bar.style.width = `${widthPercent}%`;
                
                // Texto de porcentaje y conteo en blanco, dentro de la barra
                const valueText = document.createElement('span');
                valueText.className = 'bar-text';
                valueText.textContent = `${item.value}% (${item.count})`;
                
                bar.appendChild(valueText);
                barWrapper.appendChild(bar);

                barContainer.appendChild(label);
                barContainer.appendChild(barWrapper);
                container.appendChild(barContainer);
            });
        }

        // Funci√≥n para renderizar la tabla de Tipificaci√≥n por Servicio
        function renderServicioTable() {
            const tbody = document.getElementById('table-servicio');
            dataServicio.forEach(item => {
                const row = tbody.insertRow();
                row.className = 'hover:bg-gray-50';

                // Servicio
                let cell1 = row.insertCell();
                cell1.className = 'px-3 py-2 whitespace-nowrap font-medium text-gray-900';
                cell1.textContent = item.servicio;

                // Mala Actitud
                let cell2 = row.insertCell();
                cell2.className = 'px-3 py-2 whitespace-nowrap text-center text-red-600 font-bold';
                cell2.textContent = item.malaActitud;

                // Condicionamiento Cita
                let cell3 = row.insertCell();
                cell3.className = 'px-3 py-2 whitespace-nowrap text-center text-yellow-600 font-bold';
                cell3.textContent = item.condicionCita;
            });
        }

        // Funci√≥n para renderizar el gr√°fico de pastel (Divisiones)
        function renderDivisionChart() {
            const pieContainer = document.getElementById('chart-division');
            const legendContainer = document.getElementById('pie-legend');
            
            let currentAngle = 0;
            let conicGradient = 'conic-gradient(';

            dataDivision.forEach((item, index) => {
                // Calcular el √°ngulo final
                const angle = (item.percentage / 100) * 360;
                const nextAngle = currentAngle + angle;
                
                // Mapear el color del JS a la definici√≥n de color en CSS
                const colorCode = item.color;

                conicGradient += `${colorCode} ${currentAngle}deg ${nextAngle}deg, `;
                currentAngle = nextAngle;

                // Construir Leyenda
                const legendItem = document.createElement('li');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div class="legend-color" style="background-color: ${colorCode};"></div>
                    <span>${item.division}: <strong>${item.percentage}%</strong> (${item.count} casos)</span>
                `;
                legendContainer.appendChild(legendItem);
            });

            // Limpiar la √∫ltima coma y cerrar la funci√≥n
            conicGradient = conicGradient.slice(0, -2) + ')';
            
            // Aplicar el gradiente al contenedor del pastel
            pieContainer.style.background = conicGradient;
        }

        // Ejecutar las funciones al cargar el DOM
        window.onload = function() {
            renderMotivosChart();
            renderServicioTable();
            renderDivisionChart();
        };
    </script>
</body>
</html>